<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>C# &#x2d; How to implement the plugin pattern | makolyte</title>
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- The SEO Framework by Sybre Waaijer -->
<meta name="robots" content="max-snippet:-1,max-image-preview:standard,max-video-preview:-1">
<link rel="canonical" href="/csharp-generic-plugin-loader/">
<meta name="description" content="In this article, I&rsquo;ll explain how to implement the plugin pattern. This approach uses a generic plugin loader that solves many real world problems when loading&#8230;">
<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="makolyte">
<meta property="og:title" content="C# &#x2d; How to implement the plugin pattern | makolyte">
<meta property="og:description" content="In this article, I&rsquo;ll explain how to implement the plugin pattern. This approach uses a generic plugin loader that solves many real world problems when loading plugins in .NET. Besides being generic&#8230;">
<meta property="og:url" content="/csharp-generic-plugin-loader/">
<meta property="og:image" content="/wp-content/uploads/2020/07/plugin-architecture-with-generic-loader.png">
<meta property="og:image:width" content="534">
<meta property="og:image:height" content="401">
<meta property="article:published_time" content="2020-07-05T15:14:43+00:00">
<meta property="article:modified_time" content="2025-01-26T22:29:29+00:00">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@makolyte">
<meta name="twitter:title" content="C# &#x2d; How to implement the plugin pattern | makolyte">
<meta name="twitter:description" content="In this article, I&rsquo;ll explain how to implement the plugin pattern. This approach uses a generic plugin loader that solves many real world problems when loading plugins in .NET. Besides being generic&#8230;">
<meta name="twitter:image" content="/wp-content/uploads/2020/07/plugin-architecture-with-generic-loader.png">
<script type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"/#/schema/WebSite","url":"/","name":"makolyte","description":"Solve real coding problems","inLanguage":"en-US","potentialAction":{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"/search/{search_term_string}/"},"query-input":"required name=search_term_string"},"publisher":{"@type":"Organization","@id":"/#/schema/Organization","name":"makolyte","url":"/","sameAs":"https://twitter.com/makolyte","logo":{"@type":"ImageObject","url":"/wp-content/uploads/2019/12/cropped-makolyte-icon-512-e1575418903583-4.png","contentUrl":"/wp-content/uploads/2019/12/cropped-makolyte-icon-512-e1575418903583-4.png","width":332,"height":318}}},{"@type":"WebPage","@id":"/csharp-generic-plugin-loader/","url":"/csharp-generic-plugin-loader/","name":"C# - How to implement the plugin pattern | makolyte","description":"In this article, I‚Äôll explain how to implement the plugin pattern. This approach uses a generic plugin loader that solves many real world problems when loading‚Ä¶","inLanguage":"en-US","isPartOf":{"@id":"/#/schema/WebSite"},"breadcrumb":{"@type":"BreadcrumbList","@id":"/#/schema/BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":"/","name":"makolyte"},{"@type":"ListItem","position":2,"item":"/category/csharp/","name":"C#"},{"@type":"ListItem","position":3,"name":"C# - How to implement the plugin pattern"}]},"potentialAction":{"@type":"ReadAction","target":"/csharp-generic-plugin-loader/"},"datePublished":"2020-07-05T15:14:43+00:00","dateModified":"2025-01-26T22:29:29+00:00","author":{"@type":"Person","@id":"/#/schema/Person/e99fbed30936ed203340e328108b95ee","name":"Mak"}}]}</script>


<link rel="alternate" type="application/rss+xml" title="makolyte &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="makolyte &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="makolyte &raquo; C# &#8211; How to implement the plugin pattern Comments Feed" href="/csharp-generic-plugin-loader/feed/">
<script>
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"üè≥Ô∏è‚Äç‚ößÔ∏è","üè≥Ô∏è‚Äã‚ößÔ∏è")?!1:!n(e,"üá∫üá≥","üá∫‚Äãüá≥")&&!n(e,"üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø","üè¥‚ÄãÛ†Åß‚ÄãÛ†Å¢‚ÄãÛ†Å•‚ÄãÛ†ÅÆ‚ÄãÛ†Åß‚ÄãÛ†Åø");case"emoji":return!n(e,"üê¶‚Äç‚¨õ","üê¶‚Äã‚¨õ")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
</script>
<style id="wp-emoji-styles-inline-css">img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}</style>
<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.7.2" media="all">
<link rel="stylesheet" id="syntax-highlighting-code-block-theme-css" href="/wp-content/plugins/syntax-highlighting-code-block/vendor/scrivo/highlight-php/styles/vs2015.css?ver=1.5.1" media="all">
<style id="syntax-highlighting-code-block-inline-css">.wp-block-code {
	border: 0;
	padding: 0;
	-webkit-text-size-adjust: 100%;
	text-size-adjust: 100%;
}

.wp-block-code > span {
	display: block;
	overflow: auto;
}

.shcb-language {
	border: 0;
	clip: rect(1px, 1px, 1px, 1px);
	-webkit-clip-path: inset(50%);
	clip-path: inset(50%);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
	word-wrap: normal;
	word-break: normal;
}

.hljs {
	box-sizing: border-box;
}

.hljs.shcb-code-table {
	display: table;
	width: 100%;
}

.hljs.shcb-code-table > .shcb-loc {
	color: inherit;
	display: table-row;
	width: 100%;
}

.hljs.shcb-code-table .shcb-loc > span {
	display: table-cell;
}

.wp-block-code code.hljs:not(.shcb-wrap-lines) {
	white-space: pre;
}

.wp-block-code code.hljs.shcb-wrap-lines {
	white-space: pre-wrap;
}

.hljs.shcb-line-numbers {
	border-spacing: 0;
	counter-reset: line;
}

.hljs.shcb-line-numbers > .shcb-loc {
	counter-increment: line;
}

.hljs.shcb-line-numbers .shcb-loc > span {
	padding-left: 0.75em;
}

.hljs.shcb-line-numbers .shcb-loc::before {
	border-right: 1px solid #ddd;
	content: counter(line);
	display: table-cell;
	padding: 0 0.75em;
	text-align: right;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
	white-space: nowrap;
	width: 1%;
}

.hljs > mark.shcb-loc { background-color: #3F3F3F; }</style>
<style id="classic-theme-styles-inline-css">/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}</style>
<style id="global-styles-inline-css">:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--contrast: var(--contrast);--wp--preset--color--contrast-2: var(--contrast-2);--wp--preset--color--contrast-3: var(--contrast-3);--wp--preset--color--base: var(--base);--wp--preset--color--base-2: var(--base-2);--wp--preset--color--base-3: var(--base-3);--wp--preset--color--accent: var(--accent);--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="ez-toc-css" href="/wp-content/plugins/etoc-makolyte-mod/assets/css/screen.min.css?ver=2.0.17.1" media="all">
<style id="ez-toc-inline-css">div#ez-toc-container p.ez-toc-title {font-size: 120%;}div#ez-toc-container p.ez-toc-title {font-weight: 500;}div#ez-toc-container ul li {font-size: 95%;}</style>
<link rel="stylesheet" id="related-frontend-css-css" href="/wp-content/plugins/related/css/frontend-style.css?ver=3.5.0" media="all">
<link rel="stylesheet" id="generate-style-css" href="/wp-content/themes/generatepress/assets/css/all.min.css?ver=3.3.1" media="all">
<style id="generate-style-inline-css">body{background-color:#ffffff;color:#000000;}a{color:#1e73be;}a:hover, a:focus, a:active{color:#000000;}body .grid-container{max-width:1400px;}.wp-block-group__inner-container{max-width:1400px;margin-left:auto;margin-right:auto;}.navigation-search{position:absolute;left:-99999px;pointer-events:none;visibility:hidden;z-index:20;width:100%;top:0;transition:opacity 100ms ease-in-out;opacity:0;}.navigation-search.nav-search-active{left:0;right:0;pointer-events:auto;visibility:visible;opacity:1;}.navigation-search input[type="search"]{outline:0;border:0;vertical-align:bottom;line-height:1;opacity:0.9;width:100%;z-index:20;border-radius:0;-webkit-appearance:none;height:60px;}.navigation-search input::-ms-clear{display:none;width:0;height:0;}.navigation-search input::-ms-reveal{display:none;width:0;height:0;}.navigation-search input::-webkit-search-decoration, .navigation-search input::-webkit-search-cancel-button, .navigation-search input::-webkit-search-results-button, .navigation-search input::-webkit-search-results-decoration{display:none;}.main-navigation li.search-item{z-index:21;}li.search-item.active{transition:opacity 100ms ease-in-out;}.nav-left-sidebar .main-navigation li.search-item.active,.nav-right-sidebar .main-navigation li.search-item.active{width:auto;display:inline-block;float:right;}.gen-sidebar-nav .navigation-search{top:auto;bottom:0;}:root{--contrast:#222222;--contrast-2:#575760;--contrast-3:#b2b2be;--base:#f0f0f0;--base-2:#f7f8f9;--base-3:#ffffff;--accent:#1e73be;}:root .has-contrast-color{color:var(--contrast);}:root .has-contrast-background-color{background-color:var(--contrast);}:root .has-contrast-2-color{color:var(--contrast-2);}:root .has-contrast-2-background-color{background-color:var(--contrast-2);}:root .has-contrast-3-color{color:var(--contrast-3);}:root .has-contrast-3-background-color{background-color:var(--contrast-3);}:root .has-base-color{color:var(--base);}:root .has-base-background-color{background-color:var(--base);}:root .has-base-2-color{color:var(--base-2);}:root .has-base-2-background-color{background-color:var(--base-2);}:root .has-base-3-color{color:var(--base-3);}:root .has-base-3-background-color{background-color:var(--base-3);}:root .has-accent-color{color:var(--accent);}:root .has-accent-background-color{background-color:var(--accent);}body, button, input, select, textarea{font-family:-apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";}body{line-height:1.5;}.entry-content > [class*="wp-block-"]:not(:last-child):not(.wp-block-heading){margin-bottom:1.5em;}.main-navigation .main-nav ul ul li a{font-size:14px;}.sidebar .widget, .footer-widgets .widget{font-size:17px;}h1{font-weight:300;font-size:40px;}h2{font-weight:300;font-size:30px;}h3{font-size:20px;}h4{font-size:inherit;}h5{font-size:inherit;}@media (max-width:768px){.main-title{font-size:30px;}h1{font-size:30px;}h2{font-size:25px;}}.top-bar{background-color:#636363;color:#ffffff;}.top-bar a{color:#ffffff;}.top-bar a:hover{color:#303030;}.site-header{background-color:#ffffff;color:#3a3a3a;}.site-header a{color:#3a3a3a;}.main-title a,.main-title a:hover{color:#222222;}.site-description{color:#757575;}.main-navigation,.main-navigation ul ul{background-color:#222222;}.main-navigation .main-nav ul li a, .main-navigation .menu-toggle, .main-navigation .menu-bar-items{color:#ffffff;}.main-navigation .main-nav ul li:not([class*="current-menu-"]):hover > a, .main-navigation .main-nav ul li:not([class*="current-menu-"]):focus > a, .main-navigation .main-nav ul li.sfHover:not([class*="current-menu-"]) > a, .main-navigation .menu-bar-item:hover > a, .main-navigation .menu-bar-item.sfHover > a{color:#ffffff;background-color:#3f3f3f;}button.menu-toggle:hover,button.menu-toggle:focus,.main-navigation .mobile-bar-items a,.main-navigation .mobile-bar-items a:hover,.main-navigation .mobile-bar-items a:focus{color:#ffffff;}.main-navigation .main-nav ul li[class*="current-menu-"] > a{color:#ffffff;background-color:#3f3f3f;}.navigation-search input[type="search"],.navigation-search input[type="search"]:active, .navigation-search input[type="search"]:focus, .main-navigation .main-nav ul li.search-item.active > a, .main-navigation .menu-bar-items .search-item.active > a{color:#ffffff;background-color:#3f3f3f;}.main-navigation ul ul{background-color:#3f3f3f;}.main-navigation .main-nav ul ul li a{color:#ffffff;}.main-navigation .main-nav ul ul li:not([class*="current-menu-"]):hover > a,.main-navigation .main-nav ul ul li:not([class*="current-menu-"]):focus > a, .main-navigation .main-nav ul ul li.sfHover:not([class*="current-menu-"]) > a{color:#ffffff;background-color:#4f4f4f;}.main-navigation .main-nav ul ul li[class*="current-menu-"] > a{color:#ffffff;background-color:#4f4f4f;}.separate-containers .inside-article, .separate-containers .comments-area, .separate-containers .page-header, .one-container .container, .separate-containers .paging-navigation, .inside-page-header{background-color:#ffffff;}.entry-meta{color:#595959;}.entry-meta a{color:#595959;}.entry-meta a:hover{color:#1e73be;}.sidebar .widget{background-color:#ffffff;}.sidebar .widget .widget-title{color:#000000;}.footer-widgets{background-color:#ffffff;}.footer-widgets .widget-title{color:#000000;}.site-info{color:#ffffff;background-color:#222222;}.site-info a{color:#ffffff;}.site-info a:hover{color:#606060;}.footer-bar .widget_nav_menu .current-menu-item a{color:#606060;}input[type="text"],input[type="email"],input[type="url"],input[type="password"],input[type="search"],input[type="tel"],input[type="number"],textarea,select{color:#666666;background-color:#fafafa;border-color:#cccccc;}input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="number"]:focus,textarea:focus,select:focus{color:#666666;background-color:#ffffff;border-color:#bfbfbf;}button,html input[type="button"],input[type="reset"],input[type="submit"],a.button,a.wp-block-button__link:not(.has-background){color:#ffffff;background-color:#666666;}button:hover,html input[type="button"]:hover,input[type="reset"]:hover,input[type="submit"]:hover,a.button:hover,button:focus,html input[type="button"]:focus,input[type="reset"]:focus,input[type="submit"]:focus,a.button:focus,a.wp-block-button__link:not(.has-background):active,a.wp-block-button__link:not(.has-background):focus,a.wp-block-button__link:not(.has-background):hover{color:#ffffff;background-color:#3f3f3f;}a.generate-back-to-top{background-color:rgba( 0,0,0,0.4 );color:#ffffff;}a.generate-back-to-top:hover,a.generate-back-to-top:focus{background-color:rgba( 0,0,0,0.6 );color:#ffffff;}:root{--gp-search-modal-bg-color:var(--base-3);--gp-search-modal-text-color:var(--contrast);--gp-search-modal-overlay-bg-color:rgba(0,0,0,0.2);}@media (max-width:768px){.main-navigation .menu-bar-item:hover > a, .main-navigation .menu-bar-item.sfHover > a{background:none;color:#ffffff;}}.inside-top-bar{padding:10px;}.site-main .wp-block-group__inner-container{padding:40px;}.entry-content .alignwide, body:not(.no-sidebar) .entry-content .alignfull{margin-left:-40px;width:calc(100% + 80px);max-width:calc(100% + 80px);}.container.grid-container{max-width:1480px;}.rtl .menu-item-has-children .dropdown-menu-toggle{padding-left:20px;}.rtl .main-navigation .main-nav ul li.menu-item-has-children > a{padding-right:20px;}.site-info{padding:20px;}@media (max-width:768px){.separate-containers .inside-article, .separate-containers .comments-area, .separate-containers .page-header, .separate-containers .paging-navigation, .one-container .site-content, .inside-page-header{padding:30px;}.site-main .wp-block-group__inner-container{padding:30px;}.site-info{padding-right:10px;padding-left:10px;}.entry-content .alignwide, body:not(.no-sidebar) .entry-content .alignfull{margin-left:-30px;width:calc(100% + 60px);max-width:calc(100% + 60px);}}.one-container .sidebar .widget{padding:0px;}/* End cached CSS */@media (max-width:768px){.main-navigation .menu-toggle,.main-navigation .mobile-bar-items,.sidebar-nav-mobile:not(#sticky-placeholder){display:block;}.main-navigation ul,.gen-sidebar-nav{display:none;}[class*="nav-float-"] .site-header .inside-header > *{float:none;clear:both;}}</style>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" title="JSON" type="application/json" href="/wp-json/wp/v2/posts/1816">
<script defer src="https://cloud.umami.is/script.js" data-website-id="b31b5afd-a6bb-4cbc-ad87-f7d58d45fac2"></script>
    <link rel="icon" href="/wp-content/uploads/2019/12/cropped-makolyte-icon-512-e1575418903583-1-120x120.png" sizes="32x32">
<link rel="icon" href="/wp-content/uploads/2019/12/cropped-makolyte-icon-512-e1575418903583-1-300x300.png" sizes="192x192">
<link rel="apple-touch-icon" href="/wp-content/uploads/2019/12/cropped-makolyte-icon-512-e1575418903583-1-300x300.png">
<meta name="msapplication-TileImage" content="/wp-content/uploads/2019/12/cropped-makolyte-icon-512-e1575418903583-1-300x300.png">
		<style id="wp-custom-css">.site-header .header-image {
height: 128px;
width: 91px;
}

.yarpp-related a{
    font-weight:normal !important;
}

.home-column-title {
       word-wrap: normal;
       word-break: keep-all;
	     padding-right: 4em !important;
}

.posted-on .updated {
    display: inline-block;
}

.posted-on .updated + .entry-date {
    display: none;
}

.posted-on .updated:before {
    content: "Last updated on ";
}
.posted-on .published:before {
    content: "Last updated on ";
}

.mako-grid 
{
	display:grid;
	grid-template-columns: 1fr 1fr;
	gap: 34px;
}
@media screen and (max-width: 768px)
{
	.mako-grid{
		display:grid;
		grid-template-columns: 1fr;
		gap: 34px;
	}
}

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #1E1E1E;
  color: #DCDCDC;
}

.hljs-keyword,
.hljs-literal,
.hljs-symbol,
.hljs-name {
  color: #569CD6;
}
.hljs-link {
  color: #569CD6;
  text-decoration: underline;
}

.hljs-built_in,
.hljs-type {
  color: #4EC9B0;
}

.hljs-number,
.hljs-class {
  color: #B8D7A3;
}

.hljs-string,
.hljs-meta-string {
  color: #D69D85;
}

.hljs-regexp,
.hljs-template-tag {
  color: #9A5334;
}

.hljs-subst,
.hljs-function,
.hljs-title,
.hljs-params,
.hljs-formula {
  color: #DCDCDC;
}

.hljs-comment,
.hljs-quote {
  color: #57A64A;
  font-style: italic;
}

.hljs-doctag {
  color: #608B4E;
}

.hljs-meta,
.hljs-meta-keyword,
.hljs-tag {
  color: #9B9B9B;
}

.hljs-variable,
.hljs-template-variable {
  color: #BD63C5;
}

.hljs-attr,
.hljs-attribute,
.hljs-builtin-name {
  color: #9CDCFE;
}

.hljs-section {
  color: gold;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

.hljs-bullet,
.hljs-selector-tag,
.hljs-selector-id,
.hljs-selector-class,
.hljs-selector-attr,
.hljs-selector-pseudo {
  color: #D7BA7D;
}

.hljs-addition {
  background-color: #144212;
  display: inline-block;
  width: 100%;
}

.hljs-deletion {
  background-color: #600;
  display: inline-block;
  width: 100%;
}</style>
		</head>

<body class="post-template-default single single-post postid-1816 single-format-standard wp-custom-logo wp-embed-responsive right-sidebar nav-float-right one-container fluid-header active-footer-widgets-3 nav-search-enabled header-aligned-left dropdown-hover" itemtype="https://schema.org/Blog" itemscope>
	<a class="screen-reader-text skip-link" href="#content" title="Skip to content">Skip to content</a>		<header class="site-header" id="masthead" aria-label="Site" itemtype="https://schema.org/WPHeader" itemscope>
			<div class="inside-header grid-container grid-parent">
				<div class="site-branding-container">
<div class="site-logo">
					<a href="/" rel="home">
						<img class="header-image is-logo-image" alt="makolyte" src="/wp-content/uploads/2019/12/makolyte-icon-128-e1575419011285.png">
					</a>
				</div>
<div class="site-branding">
						<p class="main-title" itemprop="headline">
					<a href="/" rel="home">
						makolyte
					</a>
				</p>
						<p class="site-description" itemprop="description">
					Solve real coding problems
				</p>
					</div>
</div>		<nav class="main-navigation grid-container grid-parent sub-menu-right" id="site-navigation" aria-label="Primary" itemtype="https://schema.org/SiteNavigationElement" itemscope>
			<div class="inside-navigation grid-container grid-parent">
				<form method="get" class="search-form navigation-search" action="/">
					<input type="search" class="search-field" value="" name="s" title="Search">
				</form>		<div class="mobile-bar-items">
						<span class="search-item">
				<a aria-label="Open Search Bar" href="#">
					<span class="gp-icon icon-search"><svg viewbox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path fill-rule="evenodd" clip-rule="evenodd" d="M208 48c-88.366 0-160 71.634-160 160s71.634 160 160 160 160-71.634 160-160S296.366 48 208 48zM0 208C0 93.125 93.125 0 208 0s208 93.125 208 208c0 48.741-16.765 93.566-44.843 129.024l133.826 134.018c9.366 9.379 9.355 24.575-.025 33.941-9.379 9.366-24.575 9.355-33.941-.025L337.238 370.987C301.747 399.167 256.839 416 208 416 93.125 416 0 322.875 0 208z"></path></svg><svg viewbox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M71.029 71.029c9.373-9.372 24.569-9.372 33.942 0L256 222.059l151.029-151.03c9.373-9.372 24.569-9.372 33.942 0 9.372 9.373 9.372 24.569 0 33.942L289.941 256l151.03 151.029c9.372 9.373 9.372 24.569 0 33.942-9.373 9.372-24.569 9.372-33.942 0L256 289.941l-151.029 151.03c-9.373 9.372-24.569 9.372-33.942 0-9.372-9.373-9.372-24.569 0-33.942L222.059 256 71.029 104.971c-9.372-9.373-9.372-24.569 0-33.942z"></path></svg></span>				</a>
			</span>
		</div>
						<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
					<span class="gp-icon icon-menu-bars"><svg viewbox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M0 96c0-13.255 10.745-24 24-24h464c13.255 0 24 10.745 24 24s-10.745 24-24 24H24c-13.255 0-24-10.745-24-24zm0 160c0-13.255 10.745-24 24-24h464c13.255 0 24 10.745 24 24s-10.745 24-24 24H24c-13.255 0-24-10.745-24-24zm0 160c0-13.255 10.745-24 24-24h464c13.255 0 24 10.745 24 24s-10.745 24-24 24H24c-13.255 0-24-10.745-24-24z"></path></svg><svg viewbox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M71.029 71.029c9.373-9.372 24.569-9.372 33.942 0L256 222.059l151.029-151.03c9.373-9.372 24.569-9.372 33.942 0 9.372 9.373 9.372 24.569 0 33.942L289.941 256l151.03 151.029c9.372 9.373 9.372 24.569 0 33.942-9.373 9.372-24.569 9.372-33.942 0L256 289.941l-151.029 151.03c-9.373 9.372-24.569 9.372-33.942 0-9.372-9.373-9.372-24.569 0-33.942L222.059 256 71.029 104.971c-9.372-9.373-9.372-24.569 0-33.942z"></path></svg></span><span class="mobile-menu">Menu</span>				</button>
				<div id="primary-menu" class="main-nav"><ul id="menu-primary-menu" class=" menu sf-menu">
<li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15"><a href="/about/">About</a></li>
<li id="menu-item-305" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-305"><a href="/category/csharp/">C#</a></li>
<li id="menu-item-185" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-185"><a href="/category/sql/">SQL</a></li>

</ul></div>			</div>
		</nav>
					</div>
		</header>
		
	<div class="site grid-container container hfeed grid-parent" id="page">
				<div class="site-content" id="content">
			
	<div class="content-area grid-parent mobile-grid-100 grid-75 tablet-grid-75" id="primary">
		<main class="site-main" id="main">
			
<article id="post-1816" class="post-1816 post type-post status-publish format-standard hentry category-csharp tag-directory-enumeratefiles tag-foreach tag-generic-type tag-generic-type-where tag-hashset tag-linq-firstordefault tag-linq-select tag-linq-tohashset tag-list tag-list-add tag-nested-foreach tag-params tag-reflection tag-searchoption-alldirectories tag-typeof" itemtype="https://schema.org/CreativeWork" itemscope>
	<div class="inside-article">
					<header class="entry-header" aria-label="Content">
				<h1 class="entry-title" itemprop="headline">C# &#8211; How to implement the plugin pattern</h1>		<div class="entry-meta">
			<span class="posted-on"><time class="updated" datetime="2025-01-26T17:29:29-05:00" itemprop="dateModified">01/26/2025</time><time class="entry-date published" datetime="2020-07-05T11:14:43-04:00" itemprop="datePublished">07/05/2020</time></span> <span class="byline">by <span class="author vcard" itemprop="author" itemtype="https://schema.org/Person" itemscope><a class="url fn n" href="/about/" title="Get to know more about Mak" rel="author" itemprop="url"><span class="author-name" itemprop="name">Mak</span></a></span></span> 		</div>
					</header>
			
		<div class="entry-content" itemprop="text">
			
<p>In this article, I&#8217;ll explain how to implement the plugin pattern. This approach uses a generic plugin loader that solves many real world problems when loading plugins in .NET. </p>



<p>Besides being generic, this plugin loader also solves the following real world problems when working with plugins:</p>



<ul class="wp-block-list">
<li>Loads assemblies that have dependencies.</li>



<li>Load assemblies that have unmanaged dependencies (like C++ DLLs).</li>



<li>Solves the &#8220;IsAssignableFrom incorrectly returns false&#8221; problem that happens in .NET Core.</li>



<li>Unloads assemblies.</li>



<li>Can pass in parameters to plugin constructors.</li>
</ul>



<p>If you find that this generic plugin loader doesn&#8217;t solve a real world problem for you, go ahead and add the functionality yourself (or leave a comment explaining the problem). <em>Note: This is an alternative to <a href="/csharp-how-to-load-assemblies-at-runtime-using-microsoft-extensibility-framework-mef/" data-type="post" data-id="6967">using MEF to load assemblies dynamically</a>.</em></p>



<h2 class="wp-block-heading">What are plugins?</h2>



<p>To put this in concrete terms, in a plugin architecture you have three assemblies:</p>



<ul class="wp-block-list">
<li>An executable program that uses plugins.</li>



<li>A DLL that defines a plugin interface.</li>



<li>One or more assemblies that implement the plugin interface. </li>
</ul>



<figure class="wp-block-image size-large"><img fetchpriority="high" decoding="async" width="534" height="401" src="/wp-content/uploads/2020/07/plugin-architecture-with-generic-loader.png" alt="Plugin architecture diagram with generic plugin loader" class="wp-image-1821" srcset="/wp-content/uploads/2020/07/plugin-architecture-with-generic-loader.png 534w, /wp-content/uploads/2020/07/plugin-architecture-with-generic-loader-300x225.png 300w" sizes="(max-width: 534px) 100vw, 534px"></figure>



<p>This approach is very flexible and allows you extend the program by plugging in new Plugin DLLs instead of having to modify the main program logic.</p>



<p>Next, I&#8217;ll explain step-by-step how to actually implement this in the code.</p>



<h2 class="wp-block-heading">1 &#8211; Create the generic plugin loader</h2>



<p>To create the generic plugin loader, implement two classes:</p>



<ul class="wp-block-list">
<li>A generic load context class. This loads assemblies.</li>



<li>A generic plugin loader class that uses the context class when creating plugin instances.</li>
</ul>



<p>First, create the generic plugin load context class by subclassing AssemblyLoadContext:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-1" data-shcb-language-name="C#" data-shcb-language-slug="cs"><span><code class="hljs language-cs shcb-code-table shcb-line-numbers shcb-wrap-lines"><span class="shcb-loc"><span><span class="hljs-keyword">using</span> System;
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">using</span> System.Collections.Generic;
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">using</span> System.Linq;
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">using</span> System.Reflection;
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">using</span> System.Runtime.Loader;
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GenericAssemblyLoadContext</span>&lt;<span class="hljs-title">T</span>&gt; : <span class="hljs-title">AssemblyLoadContext</span> <span class="hljs-title">where</span> <span class="hljs-title">T</span> : <span class="hljs-title">class</span>
</span></span><span class="shcb-loc"><span>{
</span></span><span class="shcb-loc"><span>	<span class="hljs-keyword">private</span> AssemblyDependencyResolver _resolver;
</span></span><span class="shcb-loc"><span>	<span class="hljs-keyword">private</span> HashSet&lt;<span class="hljs-keyword">string</span>&gt; assembliesToNotLoadIntoContext;
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">GenericAssemblyLoadContext</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> pluginPath</span>) : <span class="hljs-title">base</span>(<span class="hljs-params">isCollectible: <span class="hljs-literal">true</span></span>)</span>
</span></span><span class="shcb-loc"><span>	{
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">var</span> pluginInterfaceAssembly = <span class="hljs-keyword">typeof</span>(T).Assembly.FullName;
</span></span><span class="shcb-loc"><span>		assembliesToNotLoadIntoContext = GetReferencedAssemblyFullNames(pluginInterfaceAssembly);
</span></span><span class="shcb-loc"><span>		assembliesToNotLoadIntoContext.Add(pluginInterfaceAssembly);
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>		_resolver = <span class="hljs-keyword">new</span> AssemblyDependencyResolver(pluginPath);
</span></span><span class="shcb-loc"><span>	}
</span></span><span class="shcb-loc"><span>	<span class="hljs-function"><span class="hljs-keyword">private</span> HashSet&lt;<span class="hljs-keyword">string</span>&gt; <span class="hljs-title">GetReferencedAssemblyFullNames</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> ReferencedBy</span>)</span>
</span></span><span class="shcb-loc"><span>	{
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">return</span> AppDomain.CurrentDomain
</span></span><span class="shcb-loc"><span>			.GetAssemblies().FirstOrDefault(t =&gt; t.FullName == ReferencedBy)
</span></span><span class="shcb-loc"><span>			.GetReferencedAssemblies()
</span></span><span class="shcb-loc"><span>			.Select(t =&gt; t.FullName)
</span></span><span class="shcb-loc"><span>			.ToHashSet();
</span></span><span class="shcb-loc"><span>	}
</span></span><span class="shcb-loc"><span>	<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> Assembly <span class="hljs-title">Load</span>(<span class="hljs-params">AssemblyName assemblyName</span>)</span>
</span></span><span class="shcb-loc"><span>	{
</span></span><span class="shcb-loc"><span>		<span class="hljs-comment">//Do not load the Plugin Interface DLL into the adapter's context</span>
</span></span><span class="shcb-loc"><span>		<span class="hljs-comment">//otherwise IsAssignableFrom is false. </span>
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">if</span> (assembliesToNotLoadIntoContext.Contains(assemblyName.FullName))
</span></span><span class="shcb-loc"><span>		{
</span></span><span class="shcb-loc"><span>			<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
</span></span><span class="shcb-loc"><span>		}
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">string</span> assemblyPath = _resolver.ResolveAssemblyToPath(assemblyName);
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">if</span> (assemblyPath != <span class="hljs-literal">null</span>)
</span></span><span class="shcb-loc"><span>		{
</span></span><span class="shcb-loc"><span>			<span class="hljs-keyword">return</span> LoadFromAssemblyPath(assemblyPath);
</span></span><span class="shcb-loc"><span>		}
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
</span></span><span class="shcb-loc"><span>	}
</span></span><span class="shcb-loc"><span>	<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> IntPtr <span class="hljs-title">LoadUnmanagedDll</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> unmanagedDllName</span>)</span>
</span></span><span class="shcb-loc"><span>	{
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">string</span> libraryPath = _resolver.ResolveUnmanagedDllToPath(unmanagedDllName);
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">if</span> (libraryPath != <span class="hljs-literal">null</span>)
</span></span><span class="shcb-loc"><span>		{
</span></span><span class="shcb-loc"><span>			<span class="hljs-keyword">return</span> LoadUnmanagedDllFromPath(libraryPath);
</span></span><span class="shcb-loc"><span>		}
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">return</span> IntPtr.Zero;
</span></span><span class="shcb-loc"><span>	}
</span></span><span class="shcb-loc"><span>}
</span></span></code></span><small class="shcb-language" id="shcb-language-1"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C#</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cs</span><span class="shcb-language__paren">)</span></small></pre>


<p>Next, create the generic plugin loader class. This uses the generic plugin context class to load assemblies from a given directory. In each assembly, it <a href="/csharp-load-all-types-that-implement-an-interface-in-the-current-assembly/" data-type="post" data-id="1839">looks for types that implement the plugin interface</a>. It then creates instances of the plugin types, <a href="/csharp-how-to-add-to-a-list/" data-type="post" data-id="18572">adds them to a list</a>, and returns the list of plugin objects.</p>


<pre class="wp-block-code" aria-describedby="shcb-language-2" data-shcb-language-name="C#" data-shcb-language-slug="cs"><span><code class="hljs language-cs shcb-code-table shcb-line-numbers shcb-wrap-lines"><span class="shcb-loc"><span><span class="hljs-keyword">using</span> System;
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">using</span> System.Collections.Generic;
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">using</span> System.IO;
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">using</span> System.Linq;
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GenericPluginLoader</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">where</span> <span class="hljs-title">T</span> : <span class="hljs-title">class</span>
</span></span><span class="shcb-loc"><span>{
</span></span><span class="shcb-loc"><span>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> List&lt;GenericAssemblyLoadContext&lt;T&gt;&gt; loadContexts = <span class="hljs-keyword">new</span> List&lt;GenericAssemblyLoadContext&lt;T&gt;&gt;();
</span></span><span class="shcb-loc"><span>	<span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;T&gt; <span class="hljs-title">LoadAll</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> pluginPath, <span class="hljs-keyword">string</span> filter=<span class="hljs-string">"*.dll"</span>, <span class="hljs-keyword">params</span> <span class="hljs-keyword">object</span>&#91;] constructorArgs</span>)</span>
</span></span><span class="shcb-loc"><span>	{
</span></span><span class="shcb-loc"><span>		List&lt;T&gt; plugins = <span class="hljs-keyword">new</span> List&lt;T&gt;();
</span></span><span class="shcb-loc"><span>		
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> filePath <span class="hljs-keyword">in</span> Directory.EnumerateFiles(pluginPath, filter, SearchOption.AllDirectories))
</span></span><span class="shcb-loc"><span>		{
</span></span><span class="shcb-loc"><span>			<span class="hljs-keyword">var</span> plugin = Load(filePath, constructorArgs);
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>			<span class="hljs-keyword">if</span>(plugin != <span class="hljs-literal">null</span>)
</span></span><span class="shcb-loc"><span>			{
</span></span><span class="shcb-loc"><span>				plugins.Add(plugin);
</span></span><span class="shcb-loc"><span>			}
</span></span><span class="shcb-loc"><span>		}
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">return</span> plugins;
</span></span><span class="shcb-loc"><span>	}
</span></span><span class="shcb-loc"><span>	<span class="hljs-function"><span class="hljs-keyword">private</span> T <span class="hljs-title">Load</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> pluginPath, <span class="hljs-keyword">params</span> <span class="hljs-keyword">object</span>&#91;] constructorArgs</span>)</span>
</span></span><span class="shcb-loc"><span>	{
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">var</span> loadContext = <span class="hljs-keyword">new</span> GenericAssemblyLoadContext&lt;T&gt;(pluginPath);
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>		loadContexts.Add(loadContext);
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">var</span> assembly = loadContext.LoadFromAssemblyPath(pluginPath);
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">var</span> type = assembly.GetTypes().FirstOrDefault(t =&gt; <span class="hljs-keyword">typeof</span>(T).IsAssignableFrom(t));
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">if</span> (type == <span class="hljs-literal">null</span>)
</span></span><span class="shcb-loc"><span>		{
</span></span><span class="shcb-loc"><span>			<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
</span></span><span class="shcb-loc"><span>		}
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">return</span> (T)Activator.CreateInstance(type, constructorArgs);
</span></span><span class="shcb-loc"><span>	}
</span></span><span class="shcb-loc"><span>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UnloadAll</span>(<span class="hljs-params"></span>)</span>
</span></span><span class="shcb-loc"><span>	{
</span></span><span class="shcb-loc"><span>		<span class="hljs-keyword">foreach</span>(<span class="hljs-keyword">var</span> loadContext <span class="hljs-keyword">in</span> loadContexts)
</span></span><span class="shcb-loc"><span>		{
</span></span><span class="shcb-loc"><span>			loadContext.Unload();
</span></span><span class="shcb-loc"><span>		}
</span></span><span class="shcb-loc"><span>	}
</span></span><span class="shcb-loc"><span>}
</span></span></code></span><small class="shcb-language" id="shcb-language-2"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C#</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cs</span><span class="shcb-language__paren">)</span></small></pre>


<p><em>Note: This only loads one plugin type from each assembly. If you need to load multiple plugins from the same assembly, go ahead and update this to loop through assemby.GetTypes() instead of using assembly.GetTypes.GetFirstOrDefault().</em></p>



<h3 class="wp-block-heading">Why exclude the plugin interface library?</h3>



<p>If I were to load the plugin interface library into the assembly load context, then IsAssignableFrom() would be false even though it should be true. The way around this problem is to not load the plugin library or its dependencies into the plugin&#8217;s load context. </p>



<h2 class="wp-block-heading">2 &#8211; Create a plugin</h2>



<p>To create a plugin, you&#8217;ll first need a plugin interface. This is really just a plain old interface (nothing special about it). Define it based on what common behavior you want the plugins to implement. As mentioned above, you&#8217;ll want to define this in its own class library project. Here&#8217;s an example plugin interface:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-3" data-shcb-language-name="C#" data-shcb-language-slug="cs"><span><code class="hljs language-cs shcb-code-table shcb-line-numbers"><span class="shcb-loc"><span><span class="hljs-keyword">namespace</span> <span class="hljs-title">GenericPluginInterfaces</span>
</span></span><span class="shcb-loc"><span>{
</span></span><span class="shcb-loc"><span>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IMessageProcessingPlugin</span>
</span></span><span class="shcb-loc"><span>    {
</span></span><span class="shcb-loc"><span>        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Process</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> message</span>)</span>;
</span></span><span class="shcb-loc"><span>    }
</span></span><span class="shcb-loc"><span>}
</span></span></code></span><small class="shcb-language" id="shcb-language-3"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C#</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cs</span><span class="shcb-language__paren">)</span></small></pre>


<p>Now you can create a plugin by <a href="/visual-studio-how-to-make-the-implement-interface-quick-action-generate-auto-properties/" data-type="post" data-id="13360">implementing the plugin interface</a> in a class in a different class library project. This needs to reference the plugin interface. Here&#8217;s an example:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-4" data-shcb-language-name="C#" data-shcb-language-slug="cs"><span><code class="hljs language-cs shcb-code-table shcb-line-numbers shcb-wrap-lines"><span class="shcb-loc"><span><span class="hljs-keyword">using</span> GenericPluginInterfaces;
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MessageLoggingPlugin</span> : <span class="hljs-title">IMessageProcessingPlugin</span>
</span></span><span class="shcb-loc"><span>{
</span></span><span class="shcb-loc"><span>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Process</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> message</span>)</span>
</span></span><span class="shcb-loc"><span>	{
</span></span><span class="shcb-loc"><span>		Console.WriteLine(<span class="hljs-string">$"Message Logger: <span class="hljs-subst">{DateTime.Now:O}</span>\tReceived message <span class="hljs-subst">{message}</span>"</span>);
</span></span><span class="shcb-loc"><span>	}
</span></span><span class="shcb-loc"><span>}
</span></span></code></span><small class="shcb-language" id="shcb-language-4"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C#</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cs</span><span class="shcb-language__paren">)</span></small></pre>


<p><em>Note: I&#8217;m outputting the build to C:\MessagePluginProcessors\MessageLoggingPlugin\.</em></p>



<h2 class="wp-block-heading">3 &#8211; Use the plugin loader</h2>



<p>Finally, you can use the plugin loader to load the plugins and use them. There are three key steps: </p>



<ul class="wp-block-list">
<li>Load the plugins.</li>



<li>Use them.</li>



<li>Unload the plugins when they are no longer needed.</li>
</ul>



<p>Here&#8217;s an example showing how to do these steps:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-5" data-shcb-language-name="C#" data-shcb-language-slug="cs"><span><code class="hljs language-cs shcb-code-table shcb-line-numbers shcb-wrap-lines"><span class="shcb-loc"><span><span class="hljs-keyword">using</span> GenericPluginInterfaces;
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">using</span> System;
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">using</span> System.Collections.Generic;
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">var</span> pluginLoader = <span class="hljs-keyword">new</span> GenericPluginLoader&lt;IMessageProcessingPlugin&gt;();
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">//Load all plugins from a folder</span>
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">var</span> messageProcessingPlugins = pluginLoader.LoadAll(pluginPath: <span class="hljs-string">@"C:\MessagePluginProcessors\"</span>);
</span></span><span class="shcb-loc"><span>Console.WriteLine(<span class="hljs-string">$"Loaded <span class="hljs-subst">{messageProcessingPlugins.Count}</span> plugin(s)"</span>);
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">//Get messages from somewhere (hardcoding for simplicity here)</span>
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">var</span> messages = <span class="hljs-keyword">new</span> List&lt;<span class="hljs-keyword">string</span>&gt;()
</span></span><span class="shcb-loc"><span>{
</span></span><span class="shcb-loc"><span>    <span class="hljs-string">"Hello World"</span>,
</span></span><span class="shcb-loc"><span>    <span class="hljs-string">"Keep it simple"</span>,
</span></span><span class="shcb-loc"><span>    <span class="hljs-string">"Plugins are great"</span>
</span></span><span class="shcb-loc"><span>};
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">//Use plugins to process messages</span>
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> message <span class="hljs-keyword">in</span> messages)
</span></span><span class="shcb-loc"><span>{
</span></span><span class="shcb-loc"><span>    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> plugin <span class="hljs-keyword">in</span> messageProcessingPlugins)
</span></span><span class="shcb-loc"><span>    {
</span></span><span class="shcb-loc"><span>        plugin.Process(message);
</span></span><span class="shcb-loc"><span>    }
</span></span><span class="shcb-loc"><span>}
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">//unload plugins</span>
</span></span><span class="shcb-loc"><span>pluginLoader.UnloadAll();
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>Console.WriteLine(<span class="hljs-string">"Unloaded plugins"</span>);
</span></span><span class="shcb-loc"><span>Console.ReadKey();
</span></span></code></span><small class="shcb-language" id="shcb-language-5"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C#</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cs</span><span class="shcb-language__paren">)</span></small></pre>


<p>Running this code outputs the following:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-6" data-shcb-language-name="plaintext" data-shcb-language-slug="plaintext"><span><code class="hljs language-plaintext">Loaded 1 plugin(s)
Message Logger: 2022-10-25T09:50:13.1233755-04:00	Received message Hello World
Message Logger: 2022-10-25T09:50:13.1284428-04:00	Received message Keep it simple
Message Logger: 2022-10-25T09:50:13.1286210-04:00	Received message Plugins are great
Unloaded plugins</code></span><small class="shcb-language" id="shcb-language-6"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">plaintext</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">plaintext</span><span class="shcb-language__paren">)</span></small></pre>
<div class="related_content" style="clear:both;">
<h3 class="widget-title">Related Articles</h3>
									<ul class="related-posts">
										<li class="related-post">
											<a href="/csharp-get-list-of-assemblies-currently-loaded-and-output-metadata/">C# &#8211; Get all loaded assemblies</a>
										</li>
										<li class="related-post">
											<a href="/csharp-get-a-list-of-types-defined-in-an-assembly-without-loading-it/">C# &#8211; Get types from assembly (reflection-only load)</a>
										</li>
										<li class="related-post">
											<a href="/csharp-default-method-implementations-and-constants-in-interfaces/">C# &#8211; Default method implementations and constants in interfaces</a>
										</li>
										<li class="related-post">
											<a href="/csharp-load-all-types-that-implement-an-interface-in-the-current-assembly/">C# &#8211; Get all classes that implement interface</a>
										</li>
										<li class="related-post">
											<a href="/csharp-how-to-load-assemblies-at-runtime-using-microsoft-extensibility-framework-mef/">C# &#8211; How to load assemblies at runtime using Microsoft Extensibility Framework (MEF)</a>
										</li>
									</ul>
									<div style="clear:both;"></div>
</div>
							</div>

				<footer class="entry-meta" aria-label="Entry meta">
			<span class="cat-links"><span class="gp-icon icon-categories"><svg viewbox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M0 112c0-26.51 21.49-48 48-48h110.014a48 48 0 0143.592 27.907l12.349 26.791A16 16 0 00228.486 128H464c26.51 0 48 21.49 48 48v224c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112z"></path></svg></span><span class="screen-reader-text">Categories </span><a href="/category/csharp/" rel="category tag">C#</a></span> <span class="tags-links"><span class="gp-icon icon-tags"><svg viewbox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M20 39.5c-8.836 0-16 7.163-16 16v176c0 4.243 1.686 8.313 4.687 11.314l224 224c6.248 6.248 16.378 6.248 22.626 0l176-176c6.244-6.244 6.25-16.364.013-22.615l-223.5-224A15.999 15.999 0 00196.5 39.5H20zm56 96c0-13.255 10.745-24 24-24s24 10.745 24 24-10.745 24-24 24-24-10.745-24-24z"></path><path d="M259.515 43.015c4.686-4.687 12.284-4.687 16.97 0l228 228c4.686 4.686 4.686 12.284 0 16.97l-180 180c-4.686 4.687-12.284 4.687-16.97 0-4.686-4.686-4.686-12.284 0-16.97L479.029 279.5 259.515 59.985c-4.686-4.686-4.686-12.284 0-16.97z"></path></svg></span><span class="screen-reader-text">Tags </span><a href="/tag/directory-enumeratefiles/" rel="tag">directory-enumeratefiles</a>, <a href="/tag/foreach/" rel="tag">foreach</a>, <a href="/tag/generic-type/" rel="tag">generic-type</a>, <a href="/tag/generic-type-where/" rel="tag">generic-type-where</a>, <a href="/tag/hashset/" rel="tag">hashset</a>, <a href="/tag/linq-firstordefault/" rel="tag">linq-firstordefault</a>, <a href="/tag/linq-select/" rel="tag">linq-select</a>, <a href="/tag/linq-tohashset/" rel="tag">linq-tohashset</a>, <a href="/tag/list/" rel="tag">list</a>, <a href="/tag/list-add/" rel="tag">list-add</a>, <a href="/tag/nested-foreach/" rel="tag">nested-foreach</a>, <a href="/tag/params/" rel="tag">params</a>, <a href="/tag/reflection/" rel="tag">reflection</a>, <a href="/tag/searchoption-alldirectories/" rel="tag">searchoption-alldirectories</a>, <a href="/tag/typeof/" rel="tag">typeof</a></span> 		<nav id="nav-below" class="post-navigation" aria-label="Posts">
			<div class="nav-previous">
<span class="gp-icon icon-arrow-left"><svg viewbox="0 0 192 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M178.425 138.212c0 2.265-1.133 4.813-2.832 6.512L64.276 256.001l111.317 111.277c1.7 1.7 2.832 4.247 2.832 6.513 0 2.265-1.133 4.813-2.832 6.512L161.43 394.46c-1.7 1.7-4.249 2.832-6.514 2.832-2.266 0-4.816-1.133-6.515-2.832L16.407 262.514c-1.699-1.7-2.832-4.248-2.832-6.513 0-2.265 1.133-4.813 2.832-6.512l131.994-131.947c1.7-1.699 4.249-2.831 6.515-2.831 2.265 0 4.815 1.132 6.514 2.831l14.163 14.157c1.7 1.7 2.832 3.965 2.832 6.513z" fill-rule="nonzero"></path></svg></span><span class="prev"><a href="/system-invalidoperationexception-sequence-contains-no-elements/" rel="prev">Error: Sequence contains no elements</a></span>
</div>
<div class="nav-next">
<span class="gp-icon icon-arrow-right"><svg viewbox="0 0 192 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M178.425 256.001c0 2.266-1.133 4.815-2.832 6.515L43.599 394.509c-1.7 1.7-4.248 2.833-6.514 2.833s-4.816-1.133-6.515-2.833l-14.163-14.162c-1.699-1.7-2.832-3.966-2.832-6.515 0-2.266 1.133-4.815 2.832-6.515l111.317-111.316L16.407 144.685c-1.699-1.7-2.832-4.249-2.832-6.515s1.133-4.815 2.832-6.515l14.163-14.162c1.7-1.7 4.249-2.833 6.515-2.833s4.815 1.133 6.514 2.833l131.994 131.993c1.7 1.7 2.832 4.249 2.832 6.515z" fill-rule="nonzero"></path></svg></span><span class="next"><a href="/csharp-load-all-types-that-implement-an-interface-in-the-current-assembly/" rel="next">C# &#8211; Get all classes that implement interface</a></span>
</div>		</nav>
				</footer>
			</div>
</article>

			<div class="comments-area">
				<div id="comments">

	<h3 class="comments-title">6 thoughts on &ldquo;C# &#8211; How to implement the plugin pattern&rdquo;</h3>
		<ol class="comment-list">
			
		<li id="comment-48873" class="comment even thread-even depth-1 parent">
			<article class="comment-body" id="div-comment-48873" itemtype="https://schema.org/Comment" itemscope>
				<footer class="comment-meta" aria-label="Comment meta">
										<div class="comment-author-info">
						<div class="comment-author vcard" itemprop="author" itemtype="https://schema.org/Person" itemscope>
							<cite itemprop="name" class="fn">Mike</cite>						</div>

													<div class="entry-meta comment-metadata">
								<a href="/csharp-generic-plugin-loader/#comment-48873">									<time datetime="2022-12-13T08:09:16-05:00" itemprop="datePublished">
										12/13/2022 at 8:09 am									</time>
								</a>							</div>
												</div>

									</footer>

				<div class="comment-content" itemprop="text">
					<p>This was a nice tutorial. Thank you.</p>
<p>However, there are a couple of things.</p>
<p>First, it would be really nice for you to list the packages that you are including. For instance, System.Reflection and System.Runtime.Loader.</p>
<p>Second, in your main program you have the following line:</p>
<p>List messages = GetMessages();</p>
<p>I have looked and looked and I cannot find where GetMessages() is ever defined. I played around I managed to get it to work by adding it, but you should add this to your tutorial.</p>
<span class="reply"><a rel="nofollow" class="comment-reply-link" href="/csharp-generic-plugin-loader/?replytocom=48873#respond" data-commentid="48873" data-postid="1816" data-belowelement="div-comment-48873" data-respondelement="respond" data-replyto="Reply to Mike" aria-label="Reply to Mike">Reply</a></span>				</div>
			</article>
			<ul class="children">

		<li id="comment-48876" class="comment byuser comment-author-mak bypostauthor odd alt depth-2">
			<article class="comment-body" id="div-comment-48876" itemtype="https://schema.org/Comment" itemscope>
				<footer class="comment-meta" aria-label="Comment meta">
										<div class="comment-author-info">
						<div class="comment-author vcard" itemprop="author" itemtype="https://schema.org/Person" itemscope>
							<cite itemprop="name" class="fn">Maclain Wiltzer</cite>						</div>

													<div class="entry-meta comment-metadata">
								<a href="/csharp-generic-plugin-loader/#comment-48876">									<time datetime="2022-12-13T09:51:58-05:00" itemprop="datePublished">
										12/13/2022 at 9:51 am									</time>
								</a>							</div>
												</div>

									</footer>

				<div class="comment-content" itemprop="text">
					<p>Hi Mike,</p>
<p>I&#8217;m glad this helped, and thank you for the good suggestions. I&#8217;ll work on cleaning this up a bit.</p>
<p>Regarding GetMessages(), I often put placeholders in example code to not distract from the main topic. It&#8217;d probably be better to hardcode the list of messages here + add a comment to make it clear this is just a placeholder for &#8220;get your data somehow.&#8221;</p>
<p>I appreciate the helpful feedback!</p>
<span class="reply"><a rel="nofollow" class="comment-reply-link" href="/csharp-generic-plugin-loader/?replytocom=48876#respond" data-commentid="48876" data-postid="1816" data-belowelement="div-comment-48876" data-respondelement="respond" data-replyto="Reply to Maclain Wiltzer" aria-label="Reply to Maclain Wiltzer">Reply</a></span>				</div>
			</article>
			</li>
<!-- #comment-## -->
</ul>
<!-- .children -->
</li>
<!-- #comment-## -->

		<li id="comment-55418" class="comment even thread-odd thread-alt depth-1 parent">
			<article class="comment-body" id="div-comment-55418" itemtype="https://schema.org/Comment" itemscope>
				<footer class="comment-meta" aria-label="Comment meta">
										<div class="comment-author-info">
						<div class="comment-author vcard" itemprop="author" itemtype="https://schema.org/Person" itemscope>
							<cite itemprop="name" class="fn">C√¢mara G</cite>						</div>

													<div class="entry-meta comment-metadata">
								<a href="/csharp-generic-plugin-loader/#comment-55418">									<time datetime="2023-09-21T08:33:24-04:00" itemprop="datePublished">
										09/21/2023 at 8:33 am									</time>
								</a>							</div>
												</div>

									</footer>

				<div class="comment-content" itemprop="text">
					<p>Is there a way to enforce a specific order for the plugins to run?</p>
<span class="reply"><a rel="nofollow" class="comment-reply-link" href="/csharp-generic-plugin-loader/?replytocom=55418#respond" data-commentid="55418" data-postid="1816" data-belowelement="div-comment-55418" data-respondelement="respond" data-replyto="Reply to C√¢mara G" aria-label="Reply to C√¢mara G">Reply</a></span>				</div>
			</article>
			<ul class="children">

		<li id="comment-55419" class="comment byuser comment-author-mak bypostauthor odd alt depth-2">
			<article class="comment-body" id="div-comment-55419" itemtype="https://schema.org/Comment" itemscope>
				<footer class="comment-meta" aria-label="Comment meta">
										<div class="comment-author-info">
						<div class="comment-author vcard" itemprop="author" itemtype="https://schema.org/Person" itemscope>
							<cite itemprop="name" class="fn">Maclain Wiltzer</cite>						</div>

													<div class="entry-meta comment-metadata">
								<a href="/csharp-generic-plugin-loader/#comment-55419">									<time datetime="2023-09-21T09:06:34-04:00" itemprop="datePublished">
										09/21/2023 at 9:06 am									</time>
								</a>							</div>
												</div>

									</footer>

				<div class="comment-content" itemprop="text">
					<p>Hi C√¢mara,</p>
<p>Here&#8217;s one simple way to do that:<br>
1. Add &#8220;int Order&#8221; to the plugin interface.<br>
2. In each plugin implementation, specify the order that they should run. For example, plugin A goes first, so it specifies Order=1.<br>
3. In the loop where it&#8217;s executing the plugin method (plugin.Process()), get the plugins based on the Order property. For example:</p>
<p><code>foreach(var plugin in Plugins.OrderBy(p =&gt; p.Order)</code></p>
<p>That&#8217;s the simplest way to enforce ordering.</p>
<span class="reply"><a rel="nofollow" class="comment-reply-link" href="/csharp-generic-plugin-loader/?replytocom=55419#respond" data-commentid="55419" data-postid="1816" data-belowelement="div-comment-55419" data-respondelement="respond" data-replyto="Reply to Maclain Wiltzer" aria-label="Reply to Maclain Wiltzer">Reply</a></span>				</div>
			</article>
			</li>
<!-- #comment-## -->
</ul>
<!-- .children -->
</li>
<!-- #comment-## -->

		<li id="comment-59780" class="comment even thread-even depth-1 parent">
			<article class="comment-body" id="div-comment-59780" itemtype="https://schema.org/Comment" itemscope>
				<footer class="comment-meta" aria-label="Comment meta">
										<div class="comment-author-info">
						<div class="comment-author vcard" itemprop="author" itemtype="https://schema.org/Person" itemscope>
							<cite itemprop="name" class="fn">Ray Wynn</cite>						</div>

													<div class="entry-meta comment-metadata">
								<a href="/csharp-generic-plugin-loader/#comment-59780">									<time datetime="2024-03-22T19:31:29-04:00" itemprop="datePublished">
										03/22/2024 at 7:31 pm									</time>
								</a>							</div>
												</div>

									</footer>

				<div class="comment-content" itemprop="text">
					<p>Clear and simple, easy to follow. I have tried other examples that were obtuse, confusing and ultimately time wasting. Thank You</p>
<span class="reply"><a rel="nofollow" class="comment-reply-link" href="/csharp-generic-plugin-loader/?replytocom=59780#respond" data-commentid="59780" data-postid="1816" data-belowelement="div-comment-59780" data-respondelement="respond" data-replyto="Reply to Ray Wynn" aria-label="Reply to Ray Wynn">Reply</a></span>				</div>
			</article>
			<ul class="children">

		<li id="comment-59802" class="comment byuser comment-author-admin odd alt depth-2">
			<article class="comment-body" id="div-comment-59802" itemtype="https://schema.org/Comment" itemscope>
				<footer class="comment-meta" aria-label="Comment meta">
										<div class="comment-author-info">
						<div class="comment-author vcard" itemprop="author" itemtype="https://schema.org/Person" itemscope>
							<cite itemprop="name" class="fn">Mak</cite>						</div>

													<div class="entry-meta comment-metadata">
								<a href="/csharp-generic-plugin-loader/#comment-59802">									<time datetime="2024-03-23T12:38:11-04:00" itemprop="datePublished">
										03/23/2024 at 12:38 pm									</time>
								</a>							</div>
												</div>

									</footer>

				<div class="comment-content" itemprop="text">
					<p>You&#8217;re welcome!</p>
<span class="reply"><a rel="nofollow" class="comment-reply-link" href="/csharp-generic-plugin-loader/?replytocom=59802#respond" data-commentid="59802" data-postid="1816" data-belowelement="div-comment-59802" data-respondelement="respond" data-replyto="Reply to Mak" aria-label="Reply to Mak">Reply</a></span>				</div>
			</article>
			</li>
<!-- #comment-## -->
</ul>
<!-- .children -->
</li>
<!-- #comment-## -->
		</ol>
<!-- .comment-list -->

			<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/csharp-generic-plugin-loader/#respond" style="display:none;">Cancel reply</a></small>
</h3>
<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
<p class="comment-form-comment"><label for="comment" class="screen-reader-text">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" required></textarea></p>
<label for="author" class="screen-reader-text">Name</label><input placeholder="Name *" id="author" name="author" type="text" value="" size="30" required>
<label for="email" class="screen-reader-text">Email</label><input placeholder="Email *" id="email" name="email" type="email" value="" size="30" required>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="1816" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p>
</form>	</div>
<!-- #respond -->
	
</div>
<!-- #comments -->
			</div>

					</main>
	</div>

	<div class="widget-area sidebar is-right-sidebar grid-25 tablet-grid-25 grid-parent" id="right-sidebar">
	<div class="inside-right-sidebar">
		<aside id="block-19" class="widget inner-padding widget_block"><div></div></aside>	</div>
</div>

	</div>
</div>


<div class="site-footer footer-bar-active footer-bar-align-right">
			<footer class="site-info" aria-label="Site" itemtype="https://schema.org/WPFooter" itemscope>
			<div class="inside-site-info grid-container grid-parent">
						<div class="footer-bar">
			<aside id="block-11" class="widget inner-padding widget_block"></aside><aside id="block-7" class="widget inner-padding widget_block"><a href="/about/">About</a> ‚Ä¢ <a href="/privacy-policy/">Privacy Policy</a></aside>		</div>
						<div class="copyright-bar">
					<span class="copyright">&copy; 2025 makolyte</span></div>
			</div>
		</footer>
		</div>

<script id="generate-a11y">!function(){"use strict";if("querySelector"in document&&"addEventListener"in window){var e=document.body;e.addEventListener("mousedown",function(){e.classList.add("using-mouse")}),e.addEventListener("keydown",function(){e.classList.remove("using-mouse")})}}();</script><!--[if lte IE 11]>
<script src="/wp-content/themes/generatepress/assets/js/classList.min.js?ver=3.3.1" id="generate-classlist-js"></script>
<![endif]-->
<script id="generate-menu-js-extra">var generatepressMenu = {"toggleOpenedSubMenus":"1","openSubMenuLabel":"Open Sub-Menu","closeSubMenuLabel":"Close Sub-Menu"};</script>
<script src="/wp-content/themes/generatepress/assets/js/menu.min.js?ver=3.3.1" id="generate-menu-js"></script>
<script id="generate-navigation-search-js-extra">var generatepressNavSearch = {"open":"Open Search Bar","close":"Close Search Bar"};</script>
<script src="/wp-content/themes/generatepress/assets/js/navigation-search.min.js?ver=3.3.1" id="generate-navigation-search-js"></script>
<script src="/wp-includes/js/comment-reply.min.js?ver=6.7.2" id="comment-reply-js" async data-wp-strategy="async"></script>

</body>


<!-- plugin=object-cache-pro client=phpredis metric#hits=1405 metric#misses=40 metric#hit-ratio=97.2 metric#bytes=790903 metric#prefetches=0 metric#store-reads=98 metric#store-writes=10 metric#store-hits=103 metric#store-misses=36 metric#sql-queries=18 metric#ms-total=456.93 metric#ms-cache=117.59 metric#ms-cache-avg=1.0990 metric#ms-cache-ratio=25.7 -->
</html>